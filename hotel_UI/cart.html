<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700" rel="stylesheet">

    <title>Home üèòÔ∏è</title>

    <!-- Bootstrap libraries -->
    <meta name="viewport" 
    content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
    integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" 
    crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script 
    src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script
    src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
    integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
    crossorigin="anonymous"></script>

    <script 
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
    integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
    crossorigin="anonymous"></script>

<!--
Ramayana CSS Template
https://templatemo.com/tm-529-ramayana
-->

    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-style.css">
    <link rel="stylesheet" href="assets/css/owl.css">

  </head>

<body class="is-preload">

    <!-- Wrapper -->
    <div id="wrapper">

      <!-- Main -->
        <div id="main">
          <div class="inner">

            <!-- Header -->
            <header id="header">
              <div class="logo">
                <a href="index.html">Hotel</a>
              </div>
            </header>

            <!-- Page Heading -->
            <div class="page-heading">
                <div class="container-fluid">
                  <div class="row">
                    <div class="col-md-12" style="text-align: center;">
                      <h1>Cart üõí</h1>
                    </div>
                  </div>
                </div>
            </div>
          

            <!-- listing of things in cart -->
            <section class="simple-post">
                <div class="container-fluid">
                    <div class="row">
                        <div class="row-1 row-cols-1 row-cols-md-3 g-4">
                            <div id='cart_items'></div>
                        </div>
                    </div> 
                </div>         
            <section>
          </div>
        </div>  
    </div>
    <!-- Sidebar -->
    <div id="sidebar">

        <div class="inner">

          <!-- Search Box -->
          <section id="search" class="alt">
            <form method="get" action="#">
              <input type="text" name="search" id="search" placeholder="Search..." />
            </form>
          </section>
            
          <!-- Menu -->
          <nav id="menu">
            <ul>
              <li><a href="index.html">Home</a></li>
              <li><a href="profile.html">Profile</a></li>
              <li><a href="roomservice.html">Room Service</a></li>
              <li><a href="facility.html">Facility Booking</a></li>
              <li><a href="cart.html">Cart</a></li>
              <li><a href="attractions.html">Nearby Attractions</a></li>
            </ul>
          </nav>

          <!-- Featured Posts -->
          <div class="featured-posts">
            <div class="heading">
              <h2>Featured Posts</h2>
            </div>
            <div class="owl-carousel owl-theme">
              <a href="#">
                <div class="featured-item">
                  <img src="assets/images/featured_post_01.jpg" alt="featured one">
                  <p>Travel in comfort with Singapore Airlines~!</p>
                </div>
              </a>
              <a href="#">
                <div class="featured-item">
                  <img src="assets/images/featured_post_02.jpg" alt="featured two">
                  <p>Patiently waiting for your arrival...</p>
                </div>
              </a>
              <a href="#">
                <div class="featured-item">
                  <img src="assets/images/featured_post_03.jpg" alt="featured three">
                  <p>Where elegance meets comfort in the heart of the city</p>
                </div>
              </a>
            </div>
          </div>

          <!-- Footer -->
          <footer id="footer">
            <p class="copyright">Copyright &copy; 2021 The Dream Team
            <!-- <br>Designed by <a rel="nofollow" href="https://www.facebook.com/templatemo">Template Mo</a></p> -->
          </footer>

        </div>
      </div>
    </div>

    <script> 
        // Get booking_id upon log in 
      function showError(message) {
                // Hide the table and button in the event of error
                $('#cards_rs').hide();

                // Display an error under the main container
                $('#cards_rs')
                    .append("<label>" + message + "</label>");
            }
      var booking_id = sessionStorage.getItem("booking_id")
      console.log("booking_id:" + booking_id)
      //async ensure that the document is fully loaded before the function is being executed 
      // anonymous async function 
      // - using await requires the function that calls it to be async
      $(async() => {        
          // Change serviceURL to your own
          var serviceURL = "http://0.0.0.0:5100/check_cart";
          console.log(serviceURL); 
          
          //for error handling 
          try {
              const response =
               await fetch(
                 serviceURL, { method: 'GET' }
              );
              // response.json is to parse the response data as JSON into objects so that we can use it 
              const result = await response.json();
              console.log(result)
               if (response.status === 200) {
                  // success case
                  var cart_items = result.all_bookings.bookings; 
                  var rows = "";
                  for (const item of cart_items) {
                    if (item.rs_delivered_status == null){
                        item.rs_delivered_status = 'timeslot'; 
                    }
                    rows += `<div class="card mb-3">
                                <div class="row g-0">
                                  <div class="col-md-4">
                                    <img src="..." alt="...">
                                  </div>
                                  <div class="col-md-8">
                                    <div class="card-body">
                                      <h5 class="card-title"><b>${item.item_name}</b></h5>
                                      <ul class="list-group list-group-flush">
                                        <li class="list-group-item">
                                          ${item.rs_delivered_status ? 'Delivered' : 'Not delivered'}
                                        </li>                       
                                        <li class="list-group-item">
                                          <b>üí∏ Price:</b> ${item.price}
                                        </li>
                                      </ul>
                                    </div>
                                  </div>
                                </div>
                              </div>`;
                 }
                    // add all the rows to the table
                    document.getElementById('cards_rs').innerHTML = rows; 
                  } else if (response.status == 404) {
                      // No room service 
                      showError(result.message);
                  } else {
                      // unexpected outcome, throw the error
                      throw response.status;
                  }
              } catch (error) {
                  // Errors when calling the service; such as network error, 
                  // service offline, etc
                  showError
      ('There is a problem retrieving books data, please try again later.<br />' + error);
              } // error
      });
      
     

  </script>

  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/transition.js"></script>
    <script src="assets/js/owl-carousel.js"></script>
    <script src="assets/js/custom.js"></script>
</body>


  </body>

</html>
